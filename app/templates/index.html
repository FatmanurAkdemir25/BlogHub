{% extends "base.html" %}

{% block title %}Ana Sayfa - BlogHub{% endblock %}

{% block content %}
<div class="hero-section">
    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title">Hoş Geldiniz</h1>
            <p class="hero-subtitle">Harika hikayeler keşfedin ve kendi hikayenizi paylaşın</p>
            {% if not current_user.is_authenticated %}
                <a href="{{ url_for('auth.register') }}" class="btn btn-hero">Hemen Başlayın</a>
            {% endif %}
        </div>
    </div>
</div>

<div class="container">
    <div class="main-content">
        <div class="content-wrapper">
            <div class="search-filter-section">
                <form action="{{ url_for('main.index') }}" method="get" class="search-form">
                    <input type="text" name="search" placeholder="Yazı ara..." class="search-input">
                    <button type="submit" class="search-btn"><i class="fas fa-search"></i></button>
                </form>
                
                <div class="category-filter">
                    <a href="{{ url_for('main.index') }}" class="category-tag {% if not current_category %}active{% endif %}">
                        <i class="fas fa-th"></i> Tümü
                    </a>
                    {% for category in categories %}
                        <a href="{{ url_for('main.index', category=category) }}" 
                           class="category-tag {% if current_category == category %}active{% endif %}">
                            <i class="fas fa-tag"></i> {{ category }}
                        </a>
                    {% endfor %}
                </div>
            </div>

            <div class="posts-grid">
                {% for post in posts.items %}
                    <article class="post-card">
                        {% if post.image %}
                            <div class="post-image">
                                <img src="{{ url_for('static', filename='uploads/' + post.image) }}" alt="{{ post.title }}">
                                <div class="post-overlay">
                                    <a href="{{ url_for('posts.detail', id=post.id) }}" class="read-more-overlay">
                                        <i class="fas fa-arrow-right"></i>
                                    </a>
                                </div>
                            </div>
                        {% else %}
                            <div class="post-image post-no-image">
                                <i class="fas fa-file-alt"></i>
                            </div>
                        {% endif %}
                        
                        <div class="post-content">
                            <div class="post-meta">
                                <span class="post-category">
                                    <i class="fas fa-tag"></i> {{ post.category or 'Genel' }}
                                </span>
                                <span class="post-date">
                                    <i class="far fa-calendar"></i> {{ post.created_at.strftime('%d.%m.%Y') }}
                                </span>
                            </div>
                            
                            <h2 class="post-title">
                                <a href="{{ url_for('posts.detail', id=post.id) }}">{{ post.title }}</a>
                            </h2>
                            
                            <p class="post-summary">
                                {{ post.summary or post.content[:150] + '...' }}
                            </p>
                            
                            <div class="post-footer">
                                <div class="post-author">
                                    <i class="fas fa-user-circle"></i>
                                    <a href="{{ url_for('user.profile', username=post.author.username) }}">
                                        {{ post.author.username }}
                                    </a>
                                </div>
                                <div class="post-stats">
                                    <span><i class="fas fa-clock"></i> {{ post.reading_time() }} dk</span>
                                    <span><i class="fas fa-heart"></i> {{ post.get_likes_count() }}</span>
                                    <span><i class="fas fa-eye"></i> {{ post.views }}</span>
                                    <span><i class="fas fa-comment"></i> {{ post.comments|length }}</span>
                                </div>
                            </div>
                        </div>
                    </article>
                {% else %}
                    <div class="no-posts">
                        <i class="fas fa-inbox"></i>
                        <h3>Henüz yazı yok</h3>
                        <p>İlk yazıyı sen yaz!</p>
                        {% if current_user.is_authenticated %}
                            <a href="{{ url_for('posts.create') }}" class="btn btn-primary">Yazı Yaz</a>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>

            {% if posts.pages > 1 %}
                <div class="pagination">
                    {% if posts.has_prev %}
                        <a href="?page={{ posts.prev_num }}" class="page-link">
                            <i class="fas fa-chevron-left"></i> Önceki
                        </a>
                    {% endif %}
                    
                    {% for page_num in posts.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
                        {% if page_num %}
                            <a href="?page={{ page_num }}" 
                               class="page-link {% if page_num == posts.page %}active{% endif %}">
                                {{ page_num }}
                            </a>
                        {% else %}
                            <span class="page-ellipsis">...</span>
                        {% endif %}
                    {% endfor %}
                    
                    {% if posts.has_next %}
                        <a href="?page={{ posts.next_num }}" class="page-link">
                            Sonraki <i class="fas fa-chevron-right"></i>
                        </a>
                    {% endif %}
                </div>
            {% endif %}
        </div>

        <aside class="sidebar">
            <div class="sidebar-widget">
                <h3 class="widget-title"><i class="fas fa-fire"></i> Popüler Yazılar</h3>
                <div class="popular-posts">
                    {% for post in popular_posts %}
                        <div class="popular-post-item">
                            {% if post.image %}
                                <img src="{{ url_for('static', filename='uploads/' + post.image) }}" alt="{{ post.title }}">
                            {% else %}
                                <div class="popular-post-no-image"><i class="fas fa-file-alt"></i></div>
                            {% endif %}
                            <div class="popular-post-info">
                                <a href="{{ url_for('posts.detail', id=post.id) }}">{{ post.title[:50] }}...</a>
                                <span class="popular-post-views">
                                    <i class="fas fa-eye"></i> {{ post.views }}
                                </span>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>

            <div class="sidebar-widget">
                <h3 class="widget-title"><i class="fas fa-info-circle"></i> Hakkında</h3>
                <p class="widget-text">
                    BlogHub, düşüncelerinizi özgürce paylaşabileceğiniz modern bir blog platformudur. 
                    Hikayelerinizi anlatın, deneyimlerinizi paylaşın.
                </p>
            </div>

            <div class="sidebar-widget">
                <h3 class="widget-title"><i class="fas fa-tags"></i> Etiketler</h3>
                <div class="tag-cloud">
                    {% for category in categories %}
                        <a href="?category={{ category }}" class="tag-cloud-item">{{ category }}</a>
                    {% endfor %}
                </div>
            </div>
        </aside>
    </div>
</div>
{% endblock %}